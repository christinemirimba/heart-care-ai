rontend/history.html</path>
<content"><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>History - HeartCareAI</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="min-h-screen flex flex-col">
    <!-- Header -->
    <div id="header-placeholder"></div>

    <div class="flex-1 bg-gradient-to-b from-muted-30 to-background">
        <div class="container py-12">
            <div class="max-w-4xl mx-auto">
                <div class="mb-8">
                    <h1 class="text-3xl md:text-4xl font-bold mb-2">Assessment History</h1>
                    <p class="text-muted-foreground">
                        Track your cardiovascular health assessments over time
                    </p>
                </div>

                <div id="assessments-container" class="space-y-4">
                    <!-- Assessments will be loaded here -->
                </div>

                <!-- Loading State -->
                <div id="loading-state" class="card">
                    <div class="card-content py-12 text-center">
                        <div class="flex justify-center items-center">
                            <div class="loading-spinner" style="border: 2px solid hsl(var(--muted)); border-top: 2px solid hsl(var(--primary)); width: 3rem; height: 3rem;"></div>
                        </div>
                        <p class="text-sm text-muted-foreground mt-4">
                            Loading your assessment history...
                        </p>
                    </div>
                </div>

                <!-- Empty State -->
                <div id="empty-state" class="card border-dashed" style="display: none;">
                    <div class="card-content py-12 text-center">
                        <span style="font-size: 3rem;">‚ö†Ô∏è</span>
                        <p class="text-lg font-medium text-muted-foreground mb-2">
                            No assessment history yet
                        </p>
                        <p class="text-sm text-muted-foreground">
                            Complete an assessment to see your trends!
                        </p>
                        <button onclick="window.location.href='assessment.html'" class="btn btn-primary btn-default mt-4">
                            Start Assessment
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="js/main.js"></script>
    <script src="js/api.js"></script>
    <script>
        let assessments = [];

        // Load header and footer
        document.addEventListener('DOMContentLoaded', function() {
            // Check authentication
            if (!window.authManager || !window.authManager.requireAuth()) {
                return;
            }

            // Load header
            fetch('includes/header.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('header-placeholder').innerHTML = html;
                    setTimeout(() => {
                        if (window.updateAuthUI) {
                            window.updateAuthUI();
                        }
                    }, 100);
                })
                .catch(error => console.error('Error loading header:', error));

            // Load footer
            fetch('includes/footer.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('footer-placeholder').innerHTML = html;
                })
                .catch(error => console.error('Error loading footer:', error));

            // Load assessments
            loadAssessments();
        });

        async function loadAssessments() {
            try {
                const data = await window.api.getAssessmentHistory();
                assessments = data;
                renderAssessments();
            } catch (error) {
                console.error('Error loading assessments:', error);
                window.toastManager.error('Failed to load assessment history');
            } finally {
                document.getElementById('loading-state').style.display = 'none';
            }
        }

        function renderAssessments() {
            const container = document.getElementById('assessments-container');
            const emptyState = document.getElementById('empty-state');
            
            if (assessments.length === 0) {
                container.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            container.innerHTML = '';
            
            assessments.forEach((assessment, index) => {
                const trend = index < assessments.length - 1 
                    ? (assessment.risk_score < assessments[index + 1].risk_score ? 'down' : 'up')
                    : 'up';
                
                const card = createAssessmentCard(assessment, trend);
                container.appendChild(card);
            });
        }

        function createAssessmentCard(assessment, trend) {
            const card = document.createElement('div');
            card.className = 'card hover-border-primary-50 transition-colors';
            
            const riskColor = window.getRiskColor(assessment.risk_level);
            const trendIcon = trend === 'down' ? 'üìâ' : 'üìà';
            const trendColor = trend === 'down' ? 'text-green-500' : 'text-yellow-500';
            const trendText = trend === 'down' ? 'Improving' : 'Monitor closely';
            
            card.innerHTML = `
                <div class="card-header">
                    <div class="flex items-center justify-between">
                        <div class="card-title text-lg flex items-center gap-2">
                            <span style="font-size: 1.25rem;">üìÖ</span>
                            ${window.utils.formatDate(assessment.created_at)}
                        </div>
                        <span class="badge px-3 py-1 rounded-full text-sm ${riskColor}">
                            ${assessment.risk_level} Risk
                        </span>
                    </div>
                </div>
                <div class="card-content">
                    <div class="flex items-center justify-between mb-4">
                        <div class="space-y-1">
                            <p class="text-sm text-muted-foreground">Risk Score</p>
                            <p class="text-2xl font-bold">${assessment.risk_score}%</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="${trendColor}" style="font-size: 1.25rem;">${trendIcon}</span>
                            <span class="text-sm text-muted-foreground">
                                ${trendText}
                            </span>
                        </div>
                    </div>

                    <div class="mb-4">
                        <button onclick="toggleRecommendations(${assessment.id})" class="btn btn-outline btn-sm w-full">
                            <span style="font-size: 1rem;">‚ú®</span>
                            View AI Recommendations
                        </button>
                        <div id="recommendations-${assessment.id}" class="mt-4 p-4 rounded-lg" style="background-color: hsla(var(--muted), 0.3); display: none;">
                            <div class="markdown-content">${window.utils.parseMarkdown(assessment.recommendations)}</div>
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }

        function toggleRecommendations(assessmentId) {
            const recommendationsDiv = document.getElementById(`recommendations-${assessmentId}`);
            if (recommendationsDiv.style.display === 'none') {
                recommendationsDiv.style.display = 'block';
            } else {
                recommendationsDiv.style.display = 'none';
            }
        }
    </script>
</body>
</html>
